"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _fs=require("fs"),_fs2=_interopRequireDefault(_fs),_path=require("path"),_path2=_interopRequireDefault(_path),_util=require("../utils/util"),_util2=_interopRequireDefault(_util);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var projectPath=process.cwd();function compileStyle(l,e){var i=_util2.default.getRelativePath(l);if(0<l.indexOf(".xu")){var t=_util2.default.getStyle(e,l),u=i.replace(".xu",".wxss");_util2.default.writeFile(_path2.default.resolve(projectPath,u),t||""),_util2.default.log(" [写入wxss文件]".green+" dist"+u)}else 0<l.indexOf(".less")?filterComplie(l,"less").then(function(){var e=_util2.default.compileStyle(l,"less"),t=i.replace(".less",".wxss");_util2.default.writeFile(_path2.default.resolve(projectPath,t),e||""),_util2.default.log(" [写入wxss文件]".green+" dist"+t)}):0<=l.indexOf(".wxss")&&filterComplie(l,"wxss").then(function(){var e=_util2.default.compileStyle(l,"wxss");_util2.default.writeFile(_path2.default.resolve(projectPath,i),e||""),_util2.default.log(" [拷贝wxss文件]".yellow+" dist"+i)})}function filterComplie(i,u){return new Promise(function(e,t){var l=i.replace("."+u,".xu");_util2.default.hasXuFile(l)?compileStyle(l,_util2.default.readFile(l)):e()})}exports.default=compileStyle;